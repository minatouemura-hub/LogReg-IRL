# IRL with Expert Policy

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€**CartPole-v1** ãªã©ã®å¼·åŒ–å­¦ç¿’ç’°å¢ƒã«ãŠã„ã¦ã€

1. **Stable-Baselines3** ã‚’ä½¿ã£ã¦å°‚é–€å®¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§å­¦ç¿’
2. **é€†å¼·åŒ–å­¦ç¿’ï¼ˆIRLï¼‰** ãƒ¢ãƒ‡ãƒ« (`TrainIrlGrid`) ã‚’å­¦ç¿’
3. å°‚é–€å®¶ vs ãƒ©ãƒ³ãƒ€ãƒ ã®ç´¯è¨ˆå ±é…¬ã‚’æ¯”è¼ƒã—ã¦ã€IRL ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’è©•ä¾¡

ã‚’ä¸€æ‹¬ã§å®Ÿè¡Œã§ãã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆç¾¤ã‚’æä¾›ã—ã¾ã™ã€‚

---

## ğŸ“¦ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

1. **ã‚¯ãƒ­ãƒ¼ãƒ³**

   ```bash
   git clone https://github.com/yourusername/irl-project.git
   cd irl-project
   ```

2. **ç’°å¢ƒæ§‹ç¯‰**ï¼ˆæ¨å¥¨: `conda`ï¼‰

   ```bash
   conda create -n irl-env python=3.11
   conda activate irl-env
   ```

3. **ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**

   ```bash
   pip install -r requirements.txt
   ```

   * `gymnasium`
   * `stable-baselines3`
   * `torch`
   * `tqdm`
   * ãã®ä»–: `numpy`, `pandas`, `matplotlib`

---

## ğŸš€ ä½¿ã„æ–¹

### 1. å˜ç™ºå®Ÿè¡Œ: å°‚é–€å®¶å­¦ç¿’ â†’ IRL æ¨è«–

```bash
python main.py \
  --env_name CartPole-v1 \
  --algo DQN \
  --train_timesteps 100000 \
  --num_epochs 200 \
  --num_eval 500 \
  --max_steps 200
```

* `--expert_model_path` ã‚’**æŒ‡å®šã—ãªã„**å ´åˆã¯ã€å†…éƒ¨ã§ DQN/PPO ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã— `expert_{algo}_{env}.zip` ã¨ã—ã¦ä¿å­˜ã€‚ç¶šã‘ã¦ IRL æ¨è«–ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

### 2. äº‹å‰å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã†

```bash
python main.py \
  --env_name CartPole-v1 \
  --algo PPO \
  --expert_model_path /path/to/ppo_cartpole.zip \
  --num_epochs 100 \
  --num_eval 300 \
  --max_steps 200
```

* `--expert_model_path` ã« ZIP ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã™ã‚‹ã¨ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¦ IRL æ¨è«–ã®ã¿ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

---

## âš™ï¸ ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚ªãƒ—ã‚·ãƒ§ãƒ³

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³                 | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ         | èª¬æ˜                                |
| --------------------- | ------------- | --------------------------------- |
| `--env_name`          | `CartPole-v1` | Gym ç’°å¢ƒå                           |
| `--algo`              | `DQN`         | å°‚é–€å®¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  (`DQN` or `PPO`) |
| `--train_timesteps`   | `100000`      | å°‚é–€å®¶ãƒ¢ãƒ‡ãƒ«å­¦ç¿’ã®ã‚¹ãƒ†ãƒƒãƒ—æ•°                    |
| `--expert_model_path` | `None`        | äº‹å‰å­¦ç¿’æ¸ˆã¿ ZIP ãƒ¢ãƒ‡ãƒ«ã®ãƒ‘ã‚¹ (æŒ‡å®šæ™‚ã¯å­¦ç¿’ã‚’ã‚¹ã‚­ãƒƒãƒ—)   |
| `--num_epochs`        | `200`         | IRL ãƒ¢ãƒ‡ãƒ«å­¦ç¿’ã®ã‚¨ãƒãƒƒã‚¯æ•°                   |
| `--num_eval`          | `500`         | IRL è©•ä¾¡æ™‚ã®ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰æ•°                    |
| `--max_steps`         | `200`         | 1ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ã‚ãŸã‚Šã®æœ€å¤§ã‚¹ãƒ†ãƒƒãƒ—æ•°                 |

---

## ğŸ“‚ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
irl-project/
â”œâ”€â”€ main.py                # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ trainer.py             # IRL å­¦ç¿’ã‚¯ãƒ©ã‚¹ã¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå®šç¾©
â”œâ”€â”€ validation/valid/      # IRL æ¨è«– & è©•ä¾¡ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â””â”€â”€ valid.py
â”œâ”€â”€ logreg/                # é€†å¼·åŒ–å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã¨æå¤±å®šç¾©
â”‚   â”œâ”€â”€ models.py
â”‚   â””â”€â”€ modules.py
â”œâ”€â”€ requirements.txt       # Python ä¾å­˜é–¢ä¿‚
â””â”€â”€ README.md              # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦ & å®Ÿè¡Œæ‰‹é †
```

---

## ğŸ“ è§£èª¬

* `TrainIrlGrid` : CartPole-v1 ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰å°‚é–€å®¶ï¼ãƒ©ãƒ³ãƒ€ãƒ è»Œè·¡ã‚’åé›†ã—ã€IRL ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã—ã¾ã™ã€‚
* `validate_irl_with_open_model`: Stable-Baselines3 ã§å­¦ç¿’æ¸ˆã¿å°‚é–€å®¶ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã€IRL ãƒ¢ãƒ‡ãƒ«ã®å ±é…¬æ¨å®šæ€§èƒ½ã‚’è©•ä¾¡ã—ã¾ã™ã€‚

---

